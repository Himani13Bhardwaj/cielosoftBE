name: Deploy to GCP
on:
  push:
    branches: 
      - feat-gcp-deploy
      - main

env:
  SECRET_KEY: ${{ secrets.SECRET_KEY }}
  PORT: '8080'
  API_URL: ${{ secrets.API_URL }}
  API_KEY: ${{ secrets.API_KEY }}
  DEBUG: False
  DATABASE_URL: ${{ secrets.DATABASE_URL }}
  APPENGINE_URL: ${{ secrets.APPENGINE_URL }}

jobs:
  deploy-app-engine:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v3
      - name: Check secrets
        run: |
          echo $SECRET_KEY
          echo $API_URL
          echo $API_KEY
          echo $DATABASE_URL
      - name: Setup Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.9
      - name: Install requirements
        run: |
          pip install -r requirements.txt

      # - id: 'auth'
      #   uses: 'google-github-actions/auth@v0'
      #   with:
      #     credentials_json: '${{ secrets.GCP_CREDENTIALS }}'
      # - name: 'Set up Cloud SDK'
      #   uses: 'google-github-actions/setup-gcloud@v0'
      # - name: Deploy
      #   run: gcloud app deploy --quiet